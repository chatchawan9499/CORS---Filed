<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ CORS</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    select, button { padding: 6px 10px; margin-right: 10px; }
  </style>
</head>
<body>

  <h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ CORS ‡∏ï‡∏≤‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>

  <label for="province">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</label>
  <select id="province">
    <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
    <option>‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ</option>
    <option>‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
    <option>‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£</option>
    <option>‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô</option>
    <option>‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢</option>
    <option>‡∏£‡∏∞‡∏¢‡∏≠‡∏á</option>
    <option>‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°</option>
  </select>

  <button onclick="search()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>

  <div id="result"></div>

  <script>
    const apiURL = 'https://script.google.com/macros/s/AKfycbzQ69AilKo_0yKR503LqdoDTQjPmHRMJRCrgUQeZMvJ5TH8mVGsskeCEkkEE/exec?type=cors&province=';

    function search() {
      const province = document.getElementById('province').value;
      if (!province) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î");

      fetch(apiURL + encodeURIComponent(province))
        .then(res => res.json())
        .then(data => {
          if (!data.length) {
            document.getElementById('result').innerHTML = '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏µ‡πâ</p>';
            return;
          }

          let html = `<table>
            <tr>
              <th>CORS</th>
              <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
              <th>GNSS Receiver</th>
              <th>Latitude</th>
              <th>Longitude</th>
              <th>Phase</th>
            </tr>`;
          data.forEach(row => {
            html += `<tr>
              <td>${row["CORS"] || ''}</td>
              <td>${row["‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"] || ''}</td>
              <td>${row["GNSS Receiver"] || ''}</td>
              <td>${row["Latitude"] || ''}</td>
              <td>${row["Longitude"] || ''}</td>
              <td>${row["Phase"] || ''}</td>
            </tr>`;
          });
          html += `</table>`;
          document.getElementById('result').innerHTML = html;
        })
        .catch(err => {
          document.getElementById('result').innerHTML = '<p>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
          console.error(err);
        });
    }
  </script>

</body>
</html>
