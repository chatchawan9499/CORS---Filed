
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ CORS</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    select, button { padding: 6px 10px; margin-right: 10px; }
  </style>
</head>
<body>

<h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ CORS ‡∏ï‡∏≤‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h2>

<label for="province">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</label>
<select id="province">
  <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
  <option>‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£</option>
  <option>‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
  <option>‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô</option>
  <option>‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤</option>
  <option>‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</option>
  <option>‡∏¢‡∏∞‡∏•‡∏≤</option>
  <option>‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£</option>
</select>

<button onclick="search()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>

<div id="result"></div>

<script>
  const apiURL = 'https://script.google.com/macros/s/AKfycbzQ69AilKo_0yKR503LqdoDTQjPmHRMJRCrgUQeZMvJ5TH8mVGsskeCEkkEEpDNlv_/exec?type=cors&province=';

  function search() {
    const province = document.getElementById('province').value;
    if (!province) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î");

    fetch(apiURL + encodeURIComponent(province))
      .then(res => res.json())
      .then(data => {
        if (!data.length) {
          document.getElementById('result').innerHTML = '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡∏µ‡πâ</p>';
          return;
        }

        let table = '<table><tr>';
        for (let key in data[0]) {
          table += `<th>${key}</th>`;
        }
        table += '</tr>';

        data.forEach(row => {
          table += '<tr>';
          for (let key in row) {
            table += `<td>${row[key]}</td>`;
          }
          table += '</tr>';
        });
        table += '</table>';
        document.getElementById('result').innerHTML = table;
      })
      .catch(() => {
        document.getElementById('result').innerHTML = '<p>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
      });
  }
</script>

</body>
</html>
